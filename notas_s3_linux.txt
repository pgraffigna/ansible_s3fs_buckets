# s3cmd config file
touch ~/.s3cfg_bucket_15

[default]
access_key = XXXXXXXXXXX
secret_key = XXXXXXXXXXX
enable_multipart = True
multipart_chunk_size_mb = 50
use_https = True
host_base = s3.hosts.com.ar
host_bucket = s3.hosts.com.ar
cloudfront_host = cloudfront.hosts.com.ar
simpledb_host = sdb.hosts.com.ar
website_endpoint = http://%(bucket)s.s3-website-%(location)s.hosts.com.ar/

# s3cmd cli
s3cmd -c s3cfg_bucket_15 ls s3://bucket-15/media/ 
s3cmd sync --dry-run bash_scripts/ s3://min-cult-bucket-16
s3cmd sync --dry-run --skip-existing --delete-removed bash_scripts/ s3://min-cult-bucket-16
s3cmd sync --stats --limit-rate=3m --disable-multipart archivos/ s3://min-cult-bucket-16

--dry-run: prueba antes de sincronizar
--skip-existing: no chequeo de checksum
--delete-removed: lista archivos a borrar

# linux
sudo apt update && sudo apt install -y s3fs

# creando archivo con creds
echo "access_key:secret_key" | sudo tee -a /etc/passwd-s3fs && sudo chmod 600 /etc/passwd-s3fs

# creando carpeta para el bucket
sudo mkdir /mnt/s3-test

# montando el bucket
s3fs bucket-15 /var/www/html/cultura -o allow_other,uid=$(id -u www-data),gid=$(id -g www-data),umask=0022,passwd_file=/etc/passwd-s3fs,url=https://s3.host.com.ar/,use_path_request_style

# persistencia fstab
bucket-15 /mnt/s3-test fuse.s3fs _netdev,allow_other,uid=UID,gid=GID,umask=0022,use_path_request_style,passwd_file=/etc/passwd-s3fs,url=https://s3.host.com.ar/ 0 0
